val englishAsciiFreq: List[Option[Double]] = List(
  None,
  None,
  None,
  None,
  None,
  Some(6.338218895840436e-8),
  None,
  None,
  None,
  Some(1.2676437791680872e-7),
  Some(0.019578060965172565),
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  None,
  Some(6.338218895840436e-8),
  None,
  None,
  Some(6.338218895840436e-8),
  None,
  Some(0.167564443682168),
  Some(5.070575116672349e-7),
  Some(0.0015754276887500987),
  None,
  Some(5.070575116672349e-7),
  None,
  Some(0.0000020282300466689395),
  Some(0.0015078622753204398),
  Some(0.0003307916441739124),
  Some(0.0003314254660634964),
  Some(4.436753227088305e-7),
  Some(0.0000015211725350017046),
  Some(0.008634492219614468),
  Some(0.002076717421222119),
  Some(0.011055184780313847),
  Some(0.000519607185080999),
  Some(0.005918945715880591),
  Some(0.004937789430804492),
  Some(0.002756237869045172),
  Some(0.0021865587546870337),
  Some(0.0018385271551164353),
  Some(0.0025269211093936652),
  Some(0.0019199098857390264),
  Some(0.0018243295447897528),
  Some(0.002552781042488694),
  Some(0.002442242504945237),
  Some(0.00012036277683200988),
  Some(0.00000741571610813331),
  Some(0.00044107665296153596),
  Some(2.5352875583361743e-7),
  Some(0.0004404428310719519),
  Some(0.000004626899793963519),
  Some(6.338218895840436e-8),
  Some(0.0024774830020061096),
  Some(0.0017387002075069484),
  Some(0.002987392712176473),
  Some(0.0010927723198318497),
  Some(0.0012938206232079082),
  Some(0.001220297284016159),
  Some(0.0009310209736100016),
  Some(0.0008752446473266058),
  Some(0.0020910417959267183),
  Some(0.0008814561018445294),
  Some(0.0003808001912620934),
  Some(0.0010044809306127922),
  Some(0.0018134911904778657),
  Some(0.0012758834637326799),
  Some(0.0008210528757671701),
  Some(0.00138908405321239),
  Some(0.00010001709417636208),
  Some(0.0011037374385216535),
  Some(0.0030896915651553373),
  Some(0.0030701064687671904),
  Some(0.0010426370083657518),
  Some(0.0002556203680692448),
  Some(0.0008048270353938186),
  Some(0.00006572732994986532),
  Some(0.00025194420110965734),
  Some(0.00008619977698342993),
  Some(6.97204078542448e-7),
  None,
  Some(6.338218895840436e-7),
  Some(0.0000022183766135441526),
  Some(1.2676437791680872e-7),
  None,
  Some(0.0612553996079051),
  Some(0.01034644514338097),
  Some(0.02500268898936656),
  Some(0.03188948073064199),
  Some(0.08610229517681191),
  Some(0.015750347191785568),
  Some(0.012804659959943725),
  Some(0.02619237267611581),
  Some(0.05480626188138746),
  Some(0.000617596049210692),
  Some(0.004945712204424292),
  Some(0.03218192615049607),
  Some(0.018140172626462205),
  Some(0.05503703643138501),
  Some(0.0541904405334676),
  Some(0.017362092874808832),
  Some(0.00100853739070613),
  Some(0.051525029341199825),
  Some(0.0518864979648296),
  Some(0.0632964962389326),
  Some(0.019247776378510318),
  Some(0.007819143740853554),
  Some(0.009565830104169261),
  Some(0.0023064144740073764),
  Some(0.010893686962847832),
  Some(0.0005762708620098124),
  Some(6.338218895840436e-8),
  None,
  None,
  Some(1.9014656687521307e-7),
  Some(0.0000031057272589618137)
)

def scoreEnglish(buf: List[Byte]): Double = {  
  buf.map(b => (if (b < 0) None else englishAsciiFreq(b)).getOrElse(-0.1)).sum / buf.length
}

def isEnglish(score: Double): Boolean = {
  score >= 0.05
}
